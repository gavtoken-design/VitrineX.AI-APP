import{h as d,o as A,k as t,B as h,I as B,G as L,J as N}from"./index-CYQb2vCA.js";import{u as b,a as T}from"./useMediaActions-CdIS-dx2.js";import{d as w}from"./db-CogJ5b11.js";function y({title:e,titleId:a,...o},c){return d.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":a},o),e?d.createElement("title",{id:a},e):null,d.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 3.75V16.5L12 14.25 7.5 16.5V3.75m9 0H18A2.25 2.25 0 0 1 20.25 6v12A2.25 2.25 0 0 1 18 20.25H6A2.25 2.25 0 0 1 3.75 18V6A2.25 2.25 0 0 1 6 3.75h1.5m9 0h-9"}))}const C=d.forwardRef(y),M=({content:e,type:a,userId:o,initialName:c="Sem TÃ­tulo",tags:l=[],onSave:u,className:n="",variant:S="secondary",label:j="Salvar na Biblioteca",disabled:k=!1})=>{const[F,p]=d.useState(!1),[m,v]=d.useState(!1),{addToast:g}=A(),$=async()=>{if(e){p(!0);try{let s;const r=c||`Salvo ${a} ${Date.now()}`;if(e instanceof File||e instanceof Blob){const i=e instanceof File?e:new File([e],r,{type:a==="image"?"image/png":a==="video"?"video/mp4":"text/plain"});s={...await b(i,o,a),name:r,tags:l},await w(s)}else if(a==="text"||a==="post"||a==="ad"){const i=new Blob([e],{type:"text/plain"}),f=new File([i],`${r}.txt`,{type:"text/plain"});s={...await b(f,o,a),name:r,tags:l},await w(s)}else if(e.startsWith("data:")){const f=await(await fetch(e)).blob(),x=a==="image"?"png":"mp4",I=new File([f],`${r}.${x}`,{type:f.type});s={...await b(I,o,a),name:r,tags:l},await w(s)}else{const i={id:`lib-${Date.now()}`,userId:o,type:a,file_url:e,thumbnail_url:e,tags:l,name:r,createdAt:new Date().toISOString()};await w(i),s=i}v(!0),u&&u(s),setTimeout(()=>v(!1),3e3),g({type:"success",message:"Item salvo na biblioteca!"})}catch(s){console.error("Error saving to library:",s),g({type:"error",title:"Erro",message:"Falha ao salvar na biblioteca."})}finally{p(!1)}}};return t.jsxs(h,{onClick:$,isLoading:F,variant:m?"outline":S,className:`${m?"border-green-500 text-green-500 hover:text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20":""} ${n}`,disabled:k||m||!e,children:[m?t.jsx(B,{className:"w-5 h-5 mr-2"}):t.jsx(C,{className:"w-5 h-5 mr-2"}),m?"Salvo!":j]})},q=({mediaUrl:e,fileName:a,shareTitle:o="Criativo da VitrineX AI",shareText:c="Confira este criativo que gerei com a VitrineX AI!"})=>{const{handleDownload:l,handleShare:u,isProcessing:n}=T();return t.jsxs("div",{className:"flex flex-wrap gap-3",children:[t.jsxs(h,{onClick:()=>e&&l(e,a),variant:"primary",className:"w-full sm:w-auto",disabled:!e||n,isLoading:n,children:[t.jsx(L,{className:"w-4 h-4 mr-2"}),"Baixar"]}),t.jsxs(h,{onClick:()=>e&&u(e,o,c),variant:"secondary",className:"w-full sm:w-auto",disabled:!e||n,isLoading:n,children:[t.jsx(N,{className:"w-4 h-4 mr-2"}),"Compartilhar"]})]})};export{q as M,M as S};
