import{M as d}from"./constants-BAIO8zZj.js";import{h as u,o as m}from"./index-CYQb2vCA.js";const g=async(t,a,e)=>{console.log(`Simulating upload of file: ${t.name} for user ${a}, type: ${e}`),await new Promise(r=>setTimeout(r,d));const o=`https://picsum.photos/400/300?random=${Date.now()}`;if(e==="audio"){const r=`https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3?random=${Date.now()}`;return{id:`lib-${Date.now()}`,userId:a,type:e,file_url:r,thumbnail_url:void 0,tags:[],name:t.name,createdAt:new Date().toISOString()}}const n={id:`lib-${Date.now()}`,userId:a,type:e,file_url:o,thumbnail_url:e==="image"||e==="video"?o:void 0,tags:[],name:t.name,createdAt:new Date().toISOString()};return console.log("File uploaded (mock):",n),n};async function c(t){return await(await fetch(t)).blob()}function w(t){return new Promise((a,e)=>{const o=new FileReader;o.onloadend=()=>a(o.result),o.onerror=e,o.readAsDataURL(t)})}async function f(t,a){try{let e=a;if(/\.[^/.]+$/.test(e)||(e=`${e}.png`),window.electronAPI){const r=await c(t),i=await w(r),l=await window.electronAPI.saveFile(i,e);if(!l.success)throw new Error(l.error||"Cancelado pelo usuário");return!0}const o=await c(t),s=window.URL.createObjectURL(o),n=document.createElement("a");return n.href=s,n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(s),!0}catch(e){return console.error("Erro no download:",e),!1}}async function h(t,a,e){try{const o=await c(t),s=new File([o],"image.png",{type:"image/png"});return navigator.canShare&&navigator.canShare({files:[s]})?(await navigator.share({title:a,text:e,files:[s]}),!0):(console.warn("Compartilhamento de arquivos não suportado neste navegador."),!1)}catch(o){return console.error("Erro ao compartilhar:",o),!1}}const v=()=>{const[t,a]=u.useState(!1),{addToast:e}=m(),o=async(n,r)=>{if(!n)return;a(!0),e({type:"info",message:"Iniciando download..."});const i=await f(n,r);a(!1),i||e({type:"error",message:"Falha no download."})};return{handleDownload:o,handleShare:async(n,r,i)=>{if(!n)return;a(!0),await h(n,r,i)||(e({type:"info",title:"Compartilhamento Indisponível",message:"Iniciando download como alternativa."}),await o(n,r)),a(!1)},isProcessing:t}};export{v as a,f as d,g as u};
