const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/video-T6xkJKZ_.js","assets/constants-BAIO8zZj.js","assets/index-CYQb2vCA.js","assets/api-CfjT-eUR.js"])))=>i.map(i=>d[i]);
import{K as k,a5 as I}from"./index-CYQb2vCA.js";import{G as y,b as S}from"./constants-BAIO8zZj.js";import{p as T}from"./api-CfjT-eUR.js";const b=async(o,e)=>{var s;try{return((s=(await T("call-gemini","POST",{model:(e==null?void 0:e.model)||y,contents:[{role:"user",parts:[{text:o}]}],config:e})).response)==null?void 0:s.text)||""}catch(t){return console.warn("Backend proxy failed for generateText, falling back to client-side SDK.",t),(await(await k()).models.generateContent({model:(e==null?void 0:e.model)||y,contents:o,config:e})).text||""}},A=async(o,e,s,t,a)=>{const{getAuthToken:l,getActiveOrganizationId:d,BACKEND_URL:h}=await I(async()=>{const{getAuthToken:m,getActiveOrganizationId:g,BACKEND_URL:p}=await import("./api-CfjT-eUR.js").then(n=>n.b);return{getAuthToken:m,getActiveOrganizationId:g,BACKEND_URL:p}},[]);try{const m=d(),g=await l(),p={prompt:typeof e=="string"?e:e.find(r=>typeof r=="string")||"",history:o.map(r=>({role:r.role,parts:[{text:r.text}]})),model:t.model||S,options:{systemInstruction:t.systemInstruction}},n=await fetch(`${h}/organizations/${m}/ai-proxy/stream-text`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify(p),signal:a});if(!n.ok||!n.body)throw new Error(`Streaming request failed: ${n.statusText}`);const f=n.body.getReader(),i=new TextDecoder;let c="";for(;;){const{done:r,value:u}=await f.read();if(r)break;if(a!=null&&a.aborted){f.cancel();break}const w=i.decode(u);try{const x=JSON.parse(w);x.text&&(c+=x.text,s(c))}catch{c+=w,s(c)}}return c}catch(m){if(!(a!=null&&a.aborted)){console.warn("Backend proxy failed for sendMessageToChat, falling back to client-side SDK.",m);const g=await k(),p=t.model||S,n=o.map(u=>({role:u.role,parts:[{text:u.text}]})),f=g.chats.create({model:p,history:n,config:{systemInstruction:t.systemInstruction}}),i=e,c=await f.sendMessageStream({message:i});let r="";for await(const u of c){if(a!=null&&a.aborted)break;const w=u.text;w&&(r+=w,s(r))}return r}throw m}},E=async(o,e)=>({strategyText:await b(o,{model:y,systemInstruction:"You are a marketing expert...",tools:[{googleSearch:{}}],thinkingBudget:2048}),suggestions:["Suggestion 1","Suggestion 2"]}),P=async o=>{const s=await b("Create a detailed marketing campaign plan...",{model:S,responseMimeType:"application/json"});let t;try{t=JSON.parse(s)}catch{t={campaignName:"Campaign "+Date.now()}}const{generateVideo:a}=await I(async()=>{const{generateVideo:d}=await import("./video-T6xkJKZ_.js");return{generateVideo:d}},__vite__mapDeps([0,1,2,3]));let l;try{l=await a(`A short promo video for ${t.campaignName}`)}catch(d){console.warn("Video generation failed for campaign",d)}return{campaign:{id:`c-${Date.now()}`,name:t.campaignName,type:"general",posts:[],ads:[],timeline:"",createdAt:new Date().toISOString(),userId:"mock-user-123"},videoUrl:l}},C=async(o,e="en-US")=>{var t,a,l,d,h,m,g,p;const s=e==="pt-BR"?`Encontre as tendências de marketing atuais para "${o}". Forneça um resumo detalhado em português.`:`Find current marketing trends for "${o}". Provide a detailed summary.`;try{const n=await T("call-gemini","POST",{model:y,contents:[{role:"user",parts:[{text:s}]}],config:{tools:[{googleSearch:{}}]}}),f=(t=n.response)==null?void 0:t.text,i=(d=(l=(a=n.response)==null?void 0:a.candidates)==null?void 0:l[0])==null?void 0:d.groundingMetadata;return[{id:`trend-${Date.now()}`,query:o,score:85,data:f||"",sources:((h=i==null?void 0:i.groundingChunks)==null?void 0:h.map(c=>c.web))||[],createdAt:new Date().toISOString(),userId:"mock-user-123"}]}catch(n){console.warn("Backend proxy failed for searchTrends, falling back to client-side SDK.",n);const i=await(await k()).models.generateContent({model:y,contents:s,config:{tools:[{googleSearch:{}}]}}),c=i.text,r=(g=(m=i.candidates)==null?void 0:m[0])==null?void 0:g.groundingMetadata;return[{id:`trend-${Date.now()}`,query:o,score:85,data:c||"",sources:((p=r==null?void 0:r.groundingChunks)==null?void 0:p.map(u=>u.web))||[],createdAt:new Date().toISOString(),userId:"mock-user-123"}]}};export{E as a,A as b,P as c,b as g,C as s};
