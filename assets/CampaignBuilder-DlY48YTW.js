import{h as o,l as N,o as C,k as a,B as i}from"./index-CYQb2vCA.js";import{T as w}from"./Textarea-NzWuWU9_.js";import{c as k}from"./text-BDHlRMbB.js";import"./constants-BAIO8zZj.js";import"./api-CfjT-eUR.js";const P=()=>{const[l,f]=o.useState(""),[s,d]=o.useState(null),[c,m]=o.useState(null),[g,h]=o.useState(!1),[p,x]=o.useState(null),{navigateTo:u}=N(),{addToast:t}=C(),j=o.useCallback(async()=>{if(!l.trim()){t({type:"warning",message:"Por favor, forneça uma descrição para a campanha."});return}h(!0),x(null),d(null),m(null);try{const{campaign:e,videoUrl:r}=await k(l);d(e),m(r),t({type:"success",title:"Sucesso!",message:`Campanha "${e.name}" criada e salva com sucesso!`})}catch(e){console.error("Error building campaign:",e);const r=`Falha ao criar campanha: ${e instanceof Error?e.message:String(e)}`;x(r),t({type:"error",title:"Erro na Criação",message:r})}finally{h(!1)}},[l,t]),v=o.useCallback(()=>{if(!s){t({type:"warning",message:"Nenhum material de campanha para baixar."});return}const e=JSON.stringify(s,null,2),r=new Blob([e],{type:"application/json"}),b=URL.createObjectURL(r),n=document.createElement("a");n.href=b,n.download=`vitrinex-campaign-${s.name.replace(/\s/g,"-")}-${Date.now()}.json`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(b),t({type:"info",message:"Download dos materiais iniciado."})},[s,t]),y=o.useCallback(()=>{s?(u("SmartScheduler"),t({type:"info",message:`Navegando para o calendário para agendar a campanha "${s.name}".`})):t({type:"warning",message:"Nenhuma campanha gerada para adicionar ao calendário."})},[s,u,t]);return a.jsxs("div",{className:"container mx-auto py-8 lg:py-10",children:[a.jsx("h2",{className:"text-3xl font-bold text-textdark mb-8",children:"Construtor de Campanhas"}),p&&a.jsxs("div",{className:"bg-red-900 border border-red-600 text-red-300 px-4 py-3 rounded relative mb-8",role:"alert",children:[a.jsx("strong",{className:"font-bold",children:"Erro!"}),a.jsxs("span",{className:"block sm:inline",children:[" ",p]})]}),a.jsxs("div",{className:"bg-lightbg p-6 rounded-lg shadow-sm border border-gray-800 mb-8",children:[a.jsx("h3",{className:"text-xl font-semibold text-textlight mb-5",children:"Descreva sua Campanha"}),a.jsx(w,{id:"campaignPrompt",label:"Qual campanha você gostaria de criar? Seja o mais detalhado possível:",value:l,onChange:e=>f(e.target.value),rows:6,placeholder:"Ex: 'Uma campanha de lançamento para um novo curso online de fotografia avançada, visando fotógrafos amadores que querem profissionalizar seus trabalhos, duração de 2 semanas, com foco em Instagram e Facebook.'"}),a.jsx(i,{onClick:j,isLoading:g,variant:"primary",className:"w-full md:w-auto mt-4",children:g?"Criando Campanha...":"Criar Campanha"})]}),s&&a.jsxs("div",{className:"bg-lightbg p-6 rounded-lg shadow-sm border border-gray-800",children:[a.jsxs("h3",{className:"text-xl font-semibold text-textlight mb-5",children:["Campanha Gerada: ",s.name]}),a.jsxs("p",{className:"text-textlight mb-6",children:[a.jsx("span",{className:"font-semibold",children:"Cronograma:"})," ",s.timeline]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-semibold text-textlight mb-4",children:["Posts (",s.posts.length,")"]}),a.jsx("ul",{className:"list-disc list-inside text-textlight space-y-3 max-h-64 overflow-y-auto bg-darkbg p-4 rounded-md border border-gray-700",children:s.posts.map((e,r)=>a.jsxs("li",{className:"text-sm",children:[a.jsxs("strong",{children:["Post ",r+1,":"]})," ",e.content_text.substring(0,100),"..."]},e.id||r))})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-semibold text-textlight mb-4",children:["Anúncios (",s.ads.length,")"]}),a.jsx("ul",{className:"list-disc list-inside text-textlight space-y-3 max-h-64 overflow-y-auto bg-darkbg p-4 rounded-md border border-gray-700",children:s.ads.map((e,r)=>a.jsxs("li",{className:"text-sm",children:[a.jsxs("strong",{children:["Ad ",r+1," (",e.platform,"):"]}),' "',e.headline,'" - ',e.copy.substring(0,70),"..."]},e.id||r))})]})]}),c&&a.jsxs("div",{className:"mb-8",children:[a.jsx("h4",{className:"text-lg font-semibold text-textlight mb-4",children:"Vídeo da Campanha"}),a.jsx("div",{className:"relative w-full aspect-video bg-gray-900 rounded-md overflow-hidden border border-gray-700",children:a.jsx("video",{controls:!0,src:c,className:"w-full h-full object-contain"})})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[a.jsx(i,{onClick:v,variant:"primary",className:"w-full sm:w-auto",children:"Baixar Materiais"}),a.jsx(i,{onClick:y,variant:"secondary",className:"w-full sm:w-auto",children:"Adicionar ao Calendário"})]})]})]})};export{P as default};
